# Bobby Carrot 2: Winterland (HTML5 Remake)

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![Language](https://img.shields.io/badge/language-JavaScript-yellow.svg) ![Platform](https://img.shields.io/badge/platform-Web-green.svg)

> **兔子波比2：冰原之旅 (Bobby Carrot 2: Winterland)** 的原生 HTML5/Canvas 重制版。
> 复刻了经典的 J2ME 手机游戏体验，并增加了现代化的功能，如回放、参考解法和存档导出。

## 📖 简介 | Introduction

本项目使用纯原生 JavaScript (ES6+) 和 HTML5 Canvas 技术，在现代浏览器中基本还原了经典的《兔子波比2》。相比于一代，本作主要是增加了**冰面滑行**、**激光反射**等机制。

不仅还原了视觉和逻辑，还内置了基于 C++ A* 算法生成的演示功能。
## 🎮 控制 | Controls
### PC 键盘

- **移动**：W A S D 或 方向键
    
- **重置当前关**：R
    
- **暂停/菜单**：Esc
### 移动端

- 使用屏幕下方的虚拟方向键进行移动。
## 🎮 游戏规则详解 | Game Mechanics

玩家控制角色 **Bobby** (🐰)，目标是收集所有的 **能量之星** (🌟)，最后抵达 **终点** (🏁)。

### 1. 基础移动与地形
*   **操作**: 使用键盘 `方向键` 或 `W/A/S/D` 移动。
*   **障碍物**:
    *   ❄️ **雪地 / 栅栏**: 无法通过，阻挡激光。
    *   🧱 **冰块障碍**: 阻挡移动和激光。**只有被激光照射后才会融化消失**。
*   **普通地面**: 自由通行。

### 2. 🧊 冰面滑行 (Ice Slide)
这是本作的核心机制之一。
*   **滑行**: 当 Bobby 踏上冰面 (🧊) 时，脚底打滑，**无法停下**。
*   **停止**: 角色会沿着当前方向一直滑行，直到撞上**障碍物**（墙壁、未融化的冰块）或**非冰面地形**（如空地、陷阱）才会停下来。
*   **注意**: 滑行过程中经过的星星和钥匙会被自动收集。

### 3. 🔦 激光与镜子 (Lasers & Mirrors)
利用激光融化冰块是解谜的关键。
*   **激光发射器**: 地图上固定位置，向特定方向发射红外线。
*   **镜子 (◢ ◣)**:
    *   **反射**: 将射来的激光折射 90°。例如从下方射入的激光遇到 `/` 镜子会向右折射。
    *   **阻挡**: 如果激光射向镜子的背面（非反射面），激光会被吸收。
    *   **旋转**: 镜子是可以行走的。**当 Bobby 离开镜子地块后，镜子会顺时针旋转 90°**。
*   **冰块融化**: 当激光照射到 **冰块障碍** (🧱) 时，冰块会融化变成普通地面，从而打通道路。

### 4. 🔄 旋转墙与直墙 (Rotating Walls)
这些墙壁限制了通行方向，且在离开后会发生变化。

*   **直墙 (─ │)**:
    *   `─`: 仅允许左右通过。离开后变为 `│`。
    *   `│`: 仅允许上下通过。离开后变为 `─`。

*   **旋转弯管 (┌ ┐ ┘ └)**:
    *   **规则**: 必须从开口的方向进入或离开。
    *   **变化**: **当 Bobby 离开该格子后，墙壁顺时针旋转 90°**。
    *   **图解**:
        *   `┌` (右/下通): 离开后变 `┐`
        *   `┐` (左/下通): 离开后变 `┘`
        *   `┘` (左/上通): 离开后变 `└`
        *   `└` (右/上通): 离开后变 `┌`

### 5. 🎚️ 开关与陷阱
*   **红色开关 (🔴)**:
    *   踩下后，地图上**所有**的旋转墙、直墙都会顺时针旋转 90°。
    *   同时切换开关自身的颜色状态（红/暗）。
*   **陷阱 (🕳️)**:
    *   **未激活**: 看似普通地面，可以安全踩上去。
    *   **激活**: 当你**离开**该格子后，陷阱启动（露出尖刺）。
    *   **死亡**: 如果试图再次踩入已激活的陷阱，游戏结束。

### 6. 🗝️ 钥匙与锁
*   **钥匙**: 🗝️ 银钥匙 / 🔑 金钥匙 / 🥉 铜钥匙。
*   **锁 (🔒)**: 对应颜色的方块锁。只有拥有对应钥匙才能移除锁（变为平地）。

### 🏆 胜利条件
1.  搜集地图上**所有**的能量之星 (🌟)。
2.  此时终点 (🏁) 会激活并播放动画。
3.  走到终点格子上即可过关。
## 🧠 技术细节 | Technical Details

### 核心架构
游戏采用 **MVC 模式** 的变体：
*   **State (Model)**: 存储地图数据 (`16x16` 网格)、角色坐标、星星/钥匙数量、录像字符串。
*   **Game (Controller)**: 处理输入队列、执行核心逻辑（`execMove`）、状态机（Idle/Move/Slide/Death）。
*   **Renderer (View)**: 基于 `requestAnimationFrame` 的 Canvas 绘图，处理精灵动画帧序列。

### 关卡数据 (.BLM)
原版 `.blm` 二进制关卡文件已被解析并打包为 `js/levels.js`，方便网页直接读取，无需二进制流请求。

### 求解器与回放 (Solver & Replay)
为了实现“参考解法”，项目采用一个离线的 C++ A* 求解器（位于 `src/solver/`，未编译进网页）。
*   **算法**：加权 A* (Weighted A*)。
*   **启发式**：`Manhattan Distance` + `BFS Reachability Analysis`（针对冰块/锁的不可达区域进行惩罚）。
*   **原理**：求解器生成的路径字符串（如 `"uullrr..."`）被硬编码在 `js/solutions.js` 中。网页端回放引擎读取该字符串，模拟玩家输入指令，从而实现极其轻量化的回放。

## 📂 目录结构

```text
/
├── index.html          # 游戏入口
├── css/
│   └── style.css       # 冰雪主题样式
├── js/
│   ├── game.js         # 核心游戏引擎
│   ├── levels.js       # 关卡数据包
│   └── solutions.js    # 参考解法数据
└── src/
    └── ...             # 图片资源 (tilemap.png, bobby_xxx.png 等)
```

## 📜 免责声明 | Disclaimer

本项目仅供学习与技术交流使用。
原始游戏资源（图片、设计）版权归原开发者 **FDG Entertainment** 所有。
请勿将本项目用于商业用途。

---
Enjoy the Winterland! ❄️🥕


